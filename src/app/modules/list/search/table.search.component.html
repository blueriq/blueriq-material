@if (search.enabled) {
  <div bqKey bqClasses class="search">
    @if (fieldIsVisible()) {
      <mat-form-field
        floatLabel="auto"
        style="flex: 70; max-width: 70%"
        [@slideIn]="'*'"
        (@slideIn.done)="focusField()">
        <mat-chip-grid #chipList>
          @for (searchTerm of searchTerms; track searchTerm) {
            <mat-chip-row
              [removable]="true"
              (removed)="remove(searchTerm)">
              {{searchTerm}}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip-row>
          }
          <input
            type="text"
            placeholder="{{search.caption}}"
            [matChipInputFor]="chipList"
            [matChipInputSeparatorKeyCodes]="separatorKeyCodes"
            [matChipInputAddOnBlur]="true"
            (matChipInputTokenEnd)="add($event)"
            #inputField>
          </mat-chip-grid>
        </mat-form-field>
      }
      <div class="button-wrapper">
        <button
          type="button"
          mat-icon-button
          (click)="toggle()"
          [color]="opened ? undefined : 'primary'">
          @if (!opened) {
            <mat-icon>search</mat-icon>
          }
          @if (opened) {
            <mat-icon>clear</mat-icon>
          }
        </button>
      </div>
    </div>
  }
